<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Social Media Previews (Open Graph) -->
    <meta property="og:title" content="Tejas and Bhavisha's Engagement Invite!">
    <meta property="og:description" content="Please join us for a celebration. Click to watch our video invitation and RSVP :).">
    <meta property="og:image" content="https://i.imgur.com/hetJcjS.jpeg">
    <meta property="og:type" content="website">

    <title>You're Invited | Engagement Celebration</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'wedding-gold': '#00D6CE',
                        'wedding-cream': '#F9F7F2',
                        'wedding-sage': '#8A9A5B',
                        'wedding-charcoal': '#36454F',
                    },
                    fontFamily: {
                        serif: ['"Cormorant Garamond"', 'serif'],
                        sans: ['"Montserrat"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 1.5s ease-out forwards;
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .video-container video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Loading Spinner */
        .spinner {
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top: 3px solid #fff;
            width: 20px;
            height: 20px;
            -webkit-animation: spin 1s linear infinite; /* Safari */
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-wedding-cream text-wedding-charcoal antialiased">

    <!-- Navigation (Simple) -->
    <nav class="fixed w-full z-50 bg-wedding-cream/90 backdrop-blur-sm border-b border-stone-200">
        <div class="max-w-4xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="font-serif text-2xl text-wedding-gold tracking-wider">T & B</div>
            <a href="#rsvp" class="bg-wedding-charcoal text-white px-6 py-2 rounded-full font-sans text-sm tracking-wide hover:bg-wedding-gold transition duration-300">RSVP</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="min-h-screen flex flex-col justify-center items-center text-center px-4 pt-20 relative overflow-hidden">
        <!-- Decorative Background Elements -->
        <div class="absolute top-20 left-10 text-wedding-sage opacity-20 text-6xl"><i class="fas fa-leaf"></i></div>
        <div class="absolute bottom-20 right-10 text-wedding-gold opacity-20 text-6xl"><i class="far fa-heart"></i></div>

        <div class="animate-fade-in z-10 max-w-2xl w-full">
            <p class="font-sans text-wedding-sage uppercase tracking-[0.2em] mb-4 text-sm">Save the Date</p>
            <h1 class="font-serif text-6xl md:text-8xl text-wedding-charcoal mb-4 italic">Tejas & Bhavisha</h1>
            <p class="font-serif text-2xl md:text-3xl text-wedding-gold mb-12">We're Getting Engaged :)</p>
            
            <!-- VIDEO SECTION -->
            <div class="bg-white p-4 rounded-2xl shadow-xl mb-12 transform rotate-1 hover:rotate-0 transition duration-500">
                <div class="video-container bg-black">
                    <video controls playsinline poster="https://i.imgur.com/hetJcjS.jpeg">
                        <!-- 
                            IMPORTANT: 
                            1. Ensure "EngagementInvitationT&B.mp4" is in the same folder as this file.
                        -->
                        <source src="EngagementInvitationT&B.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
                <p class="mt-4 font-sans text-xs text-gray-400">Tap to get details on the invite</p>
            </div>

            <div class="flex flex-col md:flex-row justify-center items-center gap-8 font-serif text-xl border-t border-b border-stone-300 py-8 w-full">
                <div class="flex items-center gap-3">
                    <i class="far fa-calendar text-wedding-gold"></i>
                    <span>Sunday, 3rd May 2026</span>
                </div>
                <div class="hidden md:block text-stone-300">â€¢</div>
                <div class="flex items-center gap-3">
                    <i class="far fa-clock text-wedding-gold"></i>
                    <span>10:00am onwards</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Details Section -->
    <section class="py-20 bg-white">
        <div class="max-w-4xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="font-serif text-4xl mb-4">The Details</h2>
                <div class="w-24 h-1 bg-wedding-gold mx-auto"></div>
            </div>

            <div class="grid md:grid-cols-2 gap-12">
                <!-- Location -->
                <div class="text-center p-8 bg-wedding-cream rounded-lg">
                    <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-md text-wedding-gold text-2xl">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <h3 class="font-serif text-2xl mb-2">The Venue</h3>
                    <p class="font-sans text-gray-600 mb-4">The Kenya Brahma Sabha<br>3rd, Parklands avenue</p>
                    <a href="https://maps.google.com" target="_blank" class="text-wedding-sage text-sm font-bold underline hover:text-wedding-gold">View Map</a>
                </div>

                <!-- Dress Code -->
                <div class="text-center p-8 bg-wedding-cream rounded-lg">
                    <div class="w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-6 shadow-md text-wedding-gold text-2xl">
                        <i class="fas fa-glass-cheers"></i>
                    </div>
                    <h3 class="font-serif text-2xl mb-2">Dress Code</h3>
                    <p class="font-sans text-gray-600">Indian</p>
                </div>
            </div>
        </div>
    </section>

    <!-- RSVP Section -->
    <section id="rsvp" class="py-20 bg-wedding-charcoal text-wedding-cream relative">
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
        
        <div class="max-w-xl mx-auto px-4 relative z-10">
            <div class="text-center mb-10">
                <h2 class="font-serif text-4xl mb-2 text-white">Kindly Respond</h2>
                <p class="font-sans text-stone-400">Please RSVP by April 20th</p>
            </div>

            <form id="rsvpForm" class="bg-white text-gray-800 p-8 rounded-xl shadow-2xl space-y-6">
                
                <!-- Guest Name -->
                <div>
                    <label class="block font-sans text-sm font-bold text-gray-700 mb-2">Your Name</label>
                    <input type="text" id="guestName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-wedding-gold focus:border-transparent transition" placeholder="e.g., Jane Doe">
                </div>

                <!-- Attendance -->
                <div>
                    <label class="block font-sans text-sm font-bold text-gray-700 mb-2">Will you be attending?</label>
                    <div class="flex gap-4">
                        <label class="flex-1 cursor-pointer">
                            <input type="radio" name="attendance" value="Joyfully Accept" class="peer sr-only" checked>
                            <div class="text-center py-3 border border-gray-300 rounded-lg peer-checked:bg-wedding-sage peer-checked:text-white peer-checked:border-wedding-sage transition">
                                Joyfully Accept
                            </div>
                        </label>
                        <label class="flex-1 cursor-pointer">
                            <input type="radio" name="attendance" value="Regretfully Decline" class="peer sr-only">
                            <div class="text-center py-3 border border-gray-300 rounded-lg peer-checked:bg-gray-500 peer-checked:text-white peer-checked:border-gray-500 transition">
                                Regretfully Decline
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Guest Count -->
                <div id="guestCountDiv">
                    <label class="block font-sans text-sm font-bold text-gray-700 mb-2">Total Guests (Including You)</label>
                    <select id="guestCount" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-wedding-gold">
                        <option value="1">Just Me</option>
                        <option value="2">2 Guests</option>
                        <option value="3">3 Guests</option>
                        <option value="4">4 Guests</option>
                        <option value="5">5 Guests</option>
                        <option value="6">6 Guests</option>
                        <option value="7">7 Guests</option>
                        <option value="8">8 Guests</option>
                        <option value="9">9 Guests</option>
                        <option value="10">10 Guests</option>
                    </select>
                </div>

                <!-- Contact Selection (New) -->
                <div id="contactDiv">
                    <label class="block font-sans text-sm font-bold text-gray-700 mb-2">Send RSVP To</label>
                    <select id="hostSelector" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-wedding-gold">
                        <!-- Options populated by JS -->
                    </select>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitBtn" class="w-full bg-wedding-charcoal text-white font-serif text-xl py-4 rounded-lg hover:bg-wedding-gold transition duration-300 shadow-lg transform active:scale-95 flex items-center justify-center gap-2">
                    <span id="btnText">Save RSVP & Open WhatsApp</span>
                    <i class="fab fa-whatsapp"></i>
                    <div id="btnSpinner" class="spinner hidden"></div>
                </button>
                
                <p id="statusMsg" class="text-center text-xs text-gray-400 mt-2">
                    This will save your RSVP and open WhatsApp to confirm.
                </p>
            </form>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-wedding-cream py-8 text-center border-t border-stone-200">
        <p class="font-serif text-wedding-charcoal text-lg">Tejas & Bhavisha</p>
        <p class="font-sans text-xs text-stone-400 mt-2">Can't wait to celebrate with you!</p>
    </footer>

    <!-- LOGIC with FIREBASE -->
    <script type="module">
        // Import Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- CONFIGURATION ---
        // CRITICAL: UPDATE THIS LIST WITH YOUR REAL CONTACTS
        // Format: CountryCode + Number (No + sign, no spaces)
        const RSVP_HOSTS = [
            { name: "Anila", phone: "254752419162" },
            { name: "Tejas", phone: "17059776124" }
        ];

        // Initialize Firebase
        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        // UI References
        const form = document.getElementById('rsvpForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const btnSpinner = document.getElementById('btnSpinner');
        const statusMsg = document.getElementById('statusMsg');
        const hostSelector = document.getElementById('hostSelector');

        // Populate Host Dropdown
        RSVP_HOSTS.forEach(host => {
            const option = document.createElement('option');
            option.value = host.phone;
            option.textContent = host.name;
            hostSelector.appendChild(option);
        });

        // Toggle UI Helper
        function setLoading(isLoading) {
            if (isLoading) {
                submitBtn.disabled = true;
                submitBtn.classList.add('opacity-75', 'cursor-not-allowed');
                btnText.textContent = "Saving...";
                btnSpinner.classList.remove('hidden');
                document.querySelector('.fa-whatsapp').classList.add('hidden');
            } else {
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-75', 'cursor-not-allowed');
                btnText.textContent = "RSVP Sent!";
                btnSpinner.classList.add('hidden');
                document.querySelector('.fa-whatsapp').classList.remove('hidden');
            }
        }

        // Handle Form Submit
        form.addEventListener('submit', async function(e) {
            e.preventDefault();

            // 1. Get Selected Host Phone
            const selectedPhone = hostSelector.value;
            const selectedHostName = hostSelector.options[hostSelector.selectedIndex].text;

            // 2. Validation for Phone Number
            if (selectedPhone === "15551234567" || selectedPhone === "15557654321") {
                alert("Please update the RSVP_HOSTS list in the code with real numbers!");
                return;
            }

            setLoading(true);

            // 3. Get Form Values
            const name = document.getElementById('guestName').value;
            const attendance = document.querySelector('input[name="attendance"]:checked').value;
            const count = document.getElementById('guestCount').value;

            try {
                // 4. Authenticate Anonymously (Required for Database access)
                if (!auth.currentUser) {
                    await signInAnonymously(auth);
                }

                // 5. Save to Firestore Database
                const rsvpData = {
                    name: name,
                    attendance: attendance,
                    guestCount: attendance === "Joyfully Accept" ? count : 0,
                    sentTo: selectedHostName, // Store who they RSVP'd to
                    timestamp: serverTimestamp(),
                    userAgent: navigator.userAgent
                };

                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'rsvps'), rsvpData);

                // 6. Success UI
                setLoading(false);
                statusMsg.textContent = `Success! Saved. Opening WhatsApp to ${selectedHostName}...`;
                statusMsg.classList.add('text-green-600');
                statusMsg.classList.remove('text-gray-400');

                // 7. Generate WhatsApp Link & Open
                let message = "";
                if (attendance === "Joyfully Accept") {
                    message = `Hi ${selectedHostName}! ðŸ‘‹ I'd love to attend the Engagement Party! \n\nðŸ¤µ Name: ${name}\nðŸ‘¥ Total Guests: ${count}`;
                } else {
                    message = `Hi ${selectedHostName}! ðŸ‘‹ Thank you for the invite. Unfortunately, ${name} won't be able to make it. Sending my love! â¤ï¸`;
                }

                const waLink = `https://wa.me/${selectedPhone}?text=${encodeURIComponent(message)}`;
                
                // Slight delay to ensure UI updates before popup
                setTimeout(() => {
                    window.open(waLink, '_blank');
                }, 500);

            } catch (error) {
                console.error("Error saving RSVP:", error);
                setLoading(false);
                btnText.textContent = "Error - Try Again";
                statusMsg.textContent = "Could not save to database. Please check your internet.";
                statusMsg.classList.add('text-red-500');
            }
        });

        // Toggle Visibility Logic
        const radioButtons = document.querySelectorAll('input[name="attendance"]');
        const guestCountDiv = document.getElementById('guestCountDiv');

        radioButtons.forEach(radio => {
            radio.addEventListener('change', (e) => {
                if (e.target.value === 'Regretfully Decline') {
                    guestCountDiv.style.opacity = '0.5';
                    guestCountDiv.style.pointerEvents = 'none';
                } else {
                    guestCountDiv.style.opacity = '1';
                    guestCountDiv.style.pointerEvents = 'auto';
                }
            });
        });
    </script>
</body>
</html>
